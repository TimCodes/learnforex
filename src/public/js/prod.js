!function(e){function i(s){if(t[s])return t[s].exports;var a=t[s]={exports:{},id:s,loaded:!1};return e[s].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}var t={};return i.m=e,i.c=t,i.p="",i(0)}([function(e,i){"use strict";var t={screenWidth:640,screenHeight:480,delayToStartLevel:3,padding:30},s={main:"main",game:"game"},a={ship:{URL:"assets/ship.png",name:"ship"},bullet:{URL:"assets/bullet.png",name:"bullet"},asteroidLarge:{URL:"assets/asteroidLarge.png",name:"asteroidLarge"},asteroidMedium:{URL:"assets/asteroidMedium.png",name:"asteroidMedium"},asteroidSmall:{URL:"assets/asteroidSmall.png",name:"asteroidSmall"},background:{URL:"assets/background.png",name:"background"},explosionLarge:{URL:"assets/explosionLarge.png",name:"explosionLarge",width:64,height:64,frames:8},explosionMedium:{URL:"assets/explosionMedium.png",name:"explosionMedium",width:58,height:58,frames:8},explosionSmall:{URL:"assets/explosionSmall.png",name:"explosionSmall",width:41,height:41,frames:8}},o={fire:{URL:["assets/fire.m4a","assets/fire.ogg"],name:"fire"},destroyed:{URL:["assets/destroyed.m4a","assets/destroyed.ogg"],name:"destroyed"}},r={startX:.5*t.screenWidth,startY:.5*t.screenHeight,acceleration:300,drag:100,maxVelocity:300,angularVelocity:200,startingLives:3,timeToReset:3,blinkDelay:.2},n={speed:400,interval:250,lifeSpan:2e3,maxCount:30},l={startingAsteroids:4,maxAsteroids:20,incrementAsteroids:2,asteroidLarge:{minVelocity:50,maxVelocity:150,minAngularVelocity:0,maxAngularVelocity:200,score:20,nextSize:a.asteroidMedium.name,pieces:2,explosion:"explosionLarge"},asteroidMedium:{minVelocity:50,maxVelocity:200,minAngularVelocity:0,maxAngularVelocity:200,score:50,nextSize:a.asteroidSmall.name,pieces:2,explosion:"explosionMedium"},asteroidSmall:{minVelocity:50,maxVelocity:300,minAngularVelocity:0,maxAngularVelocity:200,score:100,explosion:"explosionSmall"}},h={counterFontStyle:{font:"20px Arial",fill:"#FFFFFF",align:"center"}},d=function(e){this.shipSprite,this.shipIsInvulnerable,this.key_left,this.key_right,this.key_thrust,this.key_fire,this.bulletGroup,this.asteroidGroup,this.tf_lives,this.tf_score,this.sndDestroyed,this.sndFire,this.backgroundSprite,this.explosionLargeGroup,this.explosionMediumGroup,this.explosionSmallGroup};d.prototype={preload:function(){u.load.image(a.asteroidLarge.name,a.asteroidLarge.URL),u.load.image(a.asteroidMedium.name,a.asteroidMedium.URL),u.load.image(a.asteroidSmall.name,a.asteroidSmall.URL),u.load.image(a.bullet.name,a.bullet.URL),u.load.image(a.ship.name,a.ship.URL),u.load.audio(o.destroyed.name,o.destroyed.URL),u.load.audio(o.fire.name,o.fire.URL),u.load.image(a.background.name,a.background.URL),u.load.spritesheet(a.explosionLarge.name,a.explosionLarge.URL,a.explosionLarge.width,a.explosionLarge.height,a.explosionLarge.frames),u.load.spritesheet(a.explosionMedium.name,a.explosionMedium.URL,a.explosionMedium.width,a.explosionMedium.height,a.explosionMedium.frames),u.load.spritesheet(a.explosionSmall.name,a.explosionSmall.URL,a.explosionSmall.width,a.explosionSmall.height,a.explosionSmall.frames)},init:function(){this.bulletInterval=0,this.asteroidsCount=l.startingAsteroids,this.shipLives=r.startingLives,this.score=0},create:function(){this.initGraphics(),this.initSounds(),this.initPhysics(),this.initKeyboard(),this.resetAsteroids()},update:function(){this.checkPlayerInput(),this.checkBoundaries(this.shipSprite),this.bulletGroup.forEachExists(this.checkBoundaries,this),this.asteroidGroup.forEachExists(this.checkBoundaries,this),u.physics.arcade.overlap(this.bulletGroup,this.asteroidGroup,this.asteroidCollision,null,this),this.shipIsInvulnerable||u.physics.arcade.overlap(this.shipSprite,this.asteroidGroup,this.asteroidCollision,null,this)},initGraphics:function(){this.backgroundSprite=u.add.sprite(0,0,a.background.name),this.shipSprite=u.add.sprite(r.startX,r.startY,a.ship.name),this.shipSprite.angle=-90,this.shipSprite.anchor.set(.5,.5),this.bulletGroup=u.add.group(),this.asteroidGroup=u.add.group(),this.tf_lives=u.add.text(20,10,r.startingLives,h.counterFontStyle),this.tf_score=u.add.text(t.screenWidth-20,10,"0",h.counterFontStyle),this.tf_score.align="right",this.tf_score.anchor.set(1,0),this.explosionLargeGroup=u.add.group(),this.explosionLargeGroup.createMultiple(20,a.explosionLarge.name,0),this.explosionLargeGroup.setAll("anchor.x",.5),this.explosionLargeGroup.setAll("anchor.y",.5),this.explosionLargeGroup.callAll("animations.add","animations","explode",null,30),this.explosionMediumGroup=u.add.group(),this.explosionMediumGroup.createMultiple(20,a.explosionMedium.name,0),this.explosionMediumGroup.setAll("anchor.x",.5),this.explosionMediumGroup.setAll("anchor.y",.5),this.explosionMediumGroup.callAll("animations.add","animations","explode",null,30),this.explosionSmallGroup=u.add.group(),this.explosionSmallGroup.createMultiple(20,a.explosionSmall.name,0),this.explosionSmallGroup.setAll("anchor.x",.5),this.explosionSmallGroup.setAll("anchor.y",.5),this.explosionSmallGroup.callAll("animations.add","animations","explode",null,30)},initSounds:function(){this.sndDestroyed=u.add.audio(o.destroyed.name),this.sndFire=u.add.audio(o.fire.name)},initPhysics:function(){u.physics.startSystem(Phaser.Physics.ARCADE),u.physics.enable(this.shipSprite,Phaser.Physics.ARCADE),this.shipSprite.body.drag.set(r.drag),this.shipSprite.body.maxVelocity.set(r.maxVelocity),this.bulletGroup.enableBody=!0,this.bulletGroup.physicsBodyType=Phaser.Physics.ARCADE,this.bulletGroup.createMultiple(n.maxCount,a.bullet.name),this.bulletGroup.setAll("anchor.x",.5),this.bulletGroup.setAll("anchor.y",.5),this.bulletGroup.setAll("lifespan",n.lifeSpan),this.asteroidGroup.enableBody=!0,this.asteroidGroup.physicsBodyType=Phaser.Physics.ARCADE},initKeyboard:function(){this.key_left=u.input.keyboard.addKey(Phaser.Keyboard.LEFT),this.key_right=u.input.keyboard.addKey(Phaser.Keyboard.RIGHT),this.key_thrust=u.input.keyboard.addKey(Phaser.Keyboard.UP),this.key_fire=u.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR)},checkPlayerInput:function(){this.key_left.isDown?this.shipSprite.body.angularVelocity=-r.angularVelocity:this.key_right.isDown?this.shipSprite.body.angularVelocity=r.angularVelocity:this.shipSprite.body.angularVelocity=0,this.key_thrust.isDown?u.physics.arcade.accelerationFromRotation(this.shipSprite.rotation,r.acceleration,this.shipSprite.body.acceleration):this.shipSprite.body.acceleration.set(0),this.key_fire.isDown&&this.fire()},checkBoundaries:function(e){e.x+t.padding<0?e.x=u.width+t.padding:e.x-t.padding>u.width&&(e.x=-t.padding),e.y+t.padding<0?e.y=u.height+t.padding:e.y-t.padding>u.height&&(e.y=-t.padding)},fire:function(){if(this.shipSprite.alive&&u.time.now>this.bulletInterval){this.sndFire.play();var e=this.bulletGroup.getFirstExists(!1);if(e){var i=.5*this.shipSprite.width,t=this.shipSprite.x+Math.cos(this.shipSprite.rotation)*i,s=this.shipSprite.y+Math.sin(this.shipSprite.rotation)*i;e.reset(t,s),e.lifespan=n.lifeSpan,e.rotation=this.shipSprite.rotation,u.physics.arcade.velocityFromRotation(this.shipSprite.rotation,n.speed,e.body.velocity),this.bulletInterval=u.time.now+n.interval}}},createAsteroid:function(e,i,t,s){void 0===s&&(s=1);for(var a=0;a<s;a++){var o=this.asteroidGroup.create(e,i,t);o.anchor.set(.5,.5),o.body.angularVelocity=u.rnd.integerInRange(l[t].minAngularVelocity,l[t].maxAngularVelocity);var r=u.math.degToRad(u.rnd.angle()),n=u.rnd.integerInRange(l[t].minVelocity,l[t].maxVelocity);u.physics.arcade.velocityFromRotation(r,n,o.body.velocity)}},resetAsteroids:function(){for(var e=0;e<this.asteroidsCount;e++){var i,s,o=Math.round(Math.random());o?(i=Math.round(Math.random())*t.screenWidth,s=Math.random()*t.screenHeight):(i=Math.random()*t.screenWidth,s=Math.round(Math.random())*t.screenWidth),this.createAsteroid(i,s,a.asteroidLarge.name)}},asteroidCollision:function(e,i){this.sndDestroyed.play(),e.kill(),i.kill(),e.key==a.ship.name&&this.destroyShip(),this.splitAsteroid(i),this.updateScore(l[i.key].score),this.asteroidGroup.countLiving()||u.time.events.add(Phaser.Timer.SECOND*t.delayToStartLevel,this.nextLevel,this);var s=l[i.key].explosion+"Group",o=this[s].getFirstExists(!1);o.reset(i.x,i.y),o.animations.play("explode",30,!1,!0)},destroyShip:function(){this.shipLives--,this.tf_lives.text=this.shipLives,this.shipLives?u.time.events.add(Phaser.Timer.SECOND*r.timeToReset,this.resetShip,this):u.time.events.add(Phaser.Timer.SECOND*r.timeToReset,this.endGame,this)},resetShip:function(){this.shipIsInvulnerable=!0,this.shipSprite.reset(r.startX,r.startY),this.shipSprite.angle=-90,u.time.events.add(Phaser.Timer.SECOND*r.timeToReset,this.shipReady,this),u.time.events.repeat(Phaser.Timer.SECOND*r.blinkDelay,r.timeToReset/r.blinkDelay,this.shipBlink,this)},shipReady:function(){this.shipIsInvulnerable=!1,this.shipSprite.visible=!0},shipBlink:function(){this.shipSprite.visible=!this.shipSprite.visible},splitAsteroid:function(e){l[e.key].nextSize&&this.createAsteroid(e.x,e.y,l[e.key].nextSize,l[e.key].pieces)},updateScore:function(e){this.score+=e,this.tf_score.text=this.score},nextLevel:function(){this.asteroidGroup.removeAll(!0),this.asteroidsCount<l.maxAsteroids&&(this.asteroidsCount+=l.incrementAsteroids),this.resetAsteroids()},endGame:function(){u.state.start(s.main)}};var p=function(e){this.tf_start};p.prototype={create:function(){var e="Click to Start -\n\nUP arrow key for thrust.\n\nLEFT and RIGHT arrow keys to turn.\n\nSPACE key to fire.";this.tf_start=u.add.text(u.world.centerX,u.world.centerY,e,h.counterFontStyle),this.tf_start.align="center",this.tf_start.anchor.set(.5,.5),u.input.onDown.addOnce(this.startGame,this)},startGame:function(){u.state.start(s.game)}};var u=new Phaser.Game(t.screenWidth,t.screenHeight,Phaser.AUTO,"gameDiv");u.state.add(s.main,p),u.state.add(s.game,d),u.state.start(s.main)}]);